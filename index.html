<!DOCTYPE html>
<html>
<head>
</head>
<body>
  <button id="btn">Click Me</button>
  <ul id="log"></ul>
  <script src="/socket.io/socket.io.js"></script>
  <script>
    var socket = io();
    var logElem = document.getElementById('log');
    var btnElem = document.getElementById('btn');

    var activeUser;

    socket.on('new connection', function(action) {
      if (!activeUser) activeUser = action.user;
      writeLog('new connection: ' + action.user);
    });

    socket.on('btn click', function(action) {
      writeLog('button clicked by ' + action.user);
    });

    btnElem.addEventListener('click', function(e) {
      e.preventDefault();
      socket.emit('btn click', {
        user: activeUser,
      });
    })

    function writeLog(msg) {
      var msgElem = document.createElement('li');
      msgElem.innerText = msg;
      msgElem.id = Date.now();
      logElem.appendChild(msgElem);
    }
  </script>
</body>
</html>
